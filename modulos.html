<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa de Rutas - Skópia</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Roboto:wght@400;700&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBGEwwuGLP0ULmsJkAhwwmNSlWAotGu_wY",
            projectId: "skopia-aa786",
            storageBucket: "skopia-aa786.firebasestorage.app",
            messagingSenderId: "719823055099",
            appId: "1:719823055099:web:7d91ea29e4b2dcbb9b685e"
        };

        if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
            firebaseConfig.authDomain = "localhost";
        } else {
            firebaseConfig.authDomain = "skopia-aa786.firebaseapp.com";
        }

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        onAuthStateChanged(auth, (user) => {
            if (!user) {
                window.location.href = 'index.html';
                return;
            }
            initializePage(user);
        });

        function initializePage(user) {
            const userEmailSpan = document.getElementById('user-email');
            const logoutBtn = document.getElementById('logout-btn');
            userEmailSpan.textContent = user.email;
            logoutBtn.addEventListener('click', () => {
                signOut(auth).then(() => window.location.href = 'index.html');
            });
        }
    </script>

    <style>
        :root {
            --color-crema: #fdfbf5;
            --color-oliva-claro: #bec092;
            --color-oliva-medio: #5a6133;
            --color-oliva-oscuro: #272b00;
            --color-sombra: rgba(39, 43, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, var(--color-crema) 0%, #f5efe5 100%);
            color: var(--color-oliva-oscuro);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- BARRA DE NAVEGACIÓN CON LOGO Y MENÚ --- */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 40px;
            background-color: white;
            box-shadow: 0 2px 10px var(--color-sombra);
        }
        .logo {
            height: 50px;
        }
        .hamburger {
            width: 30px;
            height: 25px;
            position: relative;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .hamburger span {
            display: block;
            height: 4px;
            width: 100%;
            background-color: var(--color-oliva-oscuro);
            border-radius: 2px;
            transition: all 0.3s ease-in-out;
        }
        .user-dropdown {
            position: absolute;
            top: 70px;
            right: 40px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px var(--color-sombra);
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: opacity 0.3s, transform 0.3s, visibility 0.3s;
            z-index: 1000;
        }
        .user-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .user-dropdown a {
            display: block;
            padding: 15px 25px;
            text-decoration: none;
            color: var(--color-oliva-oscuro);
            font-weight: 500;
            transition: background-color 0.2s;
        }
        .user-dropdown a:hover {
            background-color: var(--color-crema);
        }
        .user-dropdown hr {
            border: none;
            border-top: 1px solid #eee;
            margin: 0;
        }

        /* --- SECCIÓN CENTRAL (RELOJ Y FRASE) --- */
        .hero-section {
            text-align: center;
            padding: 40px 20px;
        }
        .digital-clock {
            font-family: 'Orbitron', sans-serif;
            font-size: 5rem;
            font-weight: 700;
            color: black;
            letter-spacing: 5px;
            text-shadow: 0 0 10px rgba(0,0,0,0.1);
            transition: color 0.3s ease;
        }
        .digital-clock.hour-change {
            color: var(--color-oliva-medio);
        }
        .motivational-quote {
            font-family: 'Patrick Hand', cursive;
            font-size: 1.8rem;
            color: var(--color-oliva-medio);
            margin-top: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            min-height: 50px; /* Evita que el diseño se mueva */
            opacity: 0;
            animation: fadeIn 1s forwards;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }

        /* --- CONTENIDO PRINCIPAL (MÓDULOS Y MASCOTA) --- */
        .main-content {
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px 40px 40px;
            gap: 50px;
        }
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            flex-grow: 1;
        }
        .module-card {
            background: white;
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 8px 25px var(--color-sombra);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }
        .module-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(39, 43, 0, 0.15);
        }
        .module-card h3 {
            font-family: 'Patrick Hand', cursive;
            font-size: 2rem;
            color: var(--color-oliva-oscuro);
            margin: 0 0 25px 0;
        }
        .start-route-btn {
            background-color: var(--color-oliva-oscuro);
            color: var(--color-crema);
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        .start-route-btn:hover {
            background-color: var(--color-oliva-medio);
            transform: scale(1.05);
        }

        /* --- MASCOTA --- */
        .mascota-container {
            flex-shrink: 0;
            text-align: center;
            position: relative;
            width: 280px;
        }
        .mascota-img {
            width: 100%;
            height: auto;
            max-width: 250px;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2));
        }
        .speech-bubble {
            position: absolute;
            top: 0;
            left: -20px;
            background: white;
            border: 2px solid var(--color-oliva-claro);
            border-radius: 20px;
            padding: 20px;
            width: 230px;
            box-shadow: 0 5px 15px var(--color-sombra);
        }
        .speech-bubble::after {
            content: '';
            position: absolute;
            right: -10px;
            top: 25px;
            border-width: 10px 0 10px 10px;
            border-style: solid;
            border-color: transparent transparent transparent var(--color-oliva-claro);
        }
        .speech-bubble p {
            font-family: 'Patrick Hand', cursive;
            font-size: 1.1rem;
            margin: 0;
        }

        /* --- COLORES DE MÓDULOS --- */
        .module-lectura { background: linear-gradient(135deg, #e8f0e3, #ddebd5); }
        .module-razonamiento { background: linear-gradient(135deg, #d9e3d0, #cddbc3); }
        .module-ciudadanas { background: linear-gradient(135deg, #c5d2b8, #b8c7aa); }
        .module-ingles { background: linear-gradient(135deg, #bec092, #b3b685); }

        @media (max-width: 1024px) {
            .main-content { flex-direction: column; }
            .modules-grid { grid-template-columns: 1fr; width: 100%; }
            .mascota-container { width: 100%; margin-top: 30px; }
            .digital-clock { font-size: 4rem; }
            .speech-bubble { position: relative; top: auto; left: auto; width: 90%; margin: 20px auto; }
            .speech-bubble::after { display: none; }
        }
    </style>
</head>

<body>
    <nav class="navbar">
        <img src="/IMAGES/logo.jpeg" alt="Logo Skópia" class="logo">
        <div class="hamburger" id="hamburger-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="user-dropdown" id="user-dropdown">
            <a href="#">Cuenta: <span id="user-email"></span></a>
            <a href="#">Configuración</a>
            <a href="#">Notificaciones</a>
            <hr>
            <a href="#" id="logout-btn">Cerrar Sesión</a>
        </div>
    </nav>

    <section class="hero-section">
        <div id="digital-clock" class="digital-clock">00:00:00</div>
        <p id="motivational-quote" class="motivational-quote"></p>
    </section>

    <main class="main-content">
        <section class="modules-grid">
            <div class="module-card module-lectura">
                <h3>Lectura Crítica</h3>
                <button class="start-route-btn">Iniciar Ruta</button>
            </div>
            <div class="module-card module-razonamiento">
                <h3>Razonamiento Cuantitativo</h3>
                <button class="start-route-btn">Iniciar Ruta</button>
            </div>
            <div class="module-card module-ciudadanas">
                <h3>Competencias Ciudadanas</h3>
                <button class="start-route-btn">Iniciar Ruta</button>
            </div>
            <div class="module-card module-ingles">
                <h3>Inglés</h3>
                <button class="start-route-btn">Iniciar Ruta</button>
            </div>
        </section>

        <aside class="mascota-container">
            <img src="/IMAGES/oso.jpeg" alt="Mascota Oso" class="mascota-img">
            <div class="speech-bubble">
                <p>Selecciona una ruta que quieras aprender</p>
            </div>
        </aside>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- LÓGICA DEL MENÚ HAMBURGUESA ---
            const hamburgerMenu = document.getElementById('hamburger-menu');
            const userDropdown = document.getElementById('user-dropdown');

            hamburgerMenu.addEventListener('click', () => {
                userDropdown.classList.toggle('active');
            });

            window.addEventListener('click', (event) => {
                if (!event.target.closest('.navbar')) {
                    userDropdown.classList.remove('active');
                }
            });

            // --- LÓGICA DEL RELOJ DIGITAL CON ANIMACIÓN ---
            const clockElement = document.getElementById('digital-clock');
            let lastHour = -1;

            function updateClock() {
                const now = new Date();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                const currentHour = now.getHours();

                if (currentHour !== lastHour) {
                    // Iniciar animación de cambio de hora
                    clockElement.classList.add('hour-change');
                    
                    setTimeout(() => {
                        clockElement.textContent = `${hours}:${minutes}:${seconds}`;
                        clockElement.classList.remove('hour-change');
                    }, 300); // Duración de la animación de color
                    lastHour = currentHour;
                } else {
                    clockElement.textContent = `${hours}:${minutes}:${seconds}`;
                }
            }
            updateClock();
            setInterval(updateClock, 1000);

            // --- LÓGICA DE FRASES MOTIVADORAS ---
            const quotes = [
                "El estudio es la llave que abre las puertas del futuro.",
                "Cada día es una nueva oportunidad para aprender algo nuevo.",
                "El conocimiento es poder, pero la curiosidad es la chispa que lo enciende.",
                "No tengas miedo a cometer errores, ten miedo a no intentar.",
                "El experto en algo fue una vez un principiante.",
                "El éxito es la suma de pequeños esfuerzos repetidos día tras día."
            ];
            let currentQuoteIndex = 0;
            const quoteElement = document.getElementById('motivational-quote');

            function changeQuote() {
                quoteElement.style.animation = 'none'; // Resetear animación
                setTimeout(() => {
                    quoteElement.textContent = quotes[currentQuoteIndex];
                    quoteElement.style.animation = 'fadeIn 1s forwards';
                    currentQuoteIndex = (currentQuoteIndex + 1) % quotes.length;
                }, 20); // Pequeño delay para que el reseteo surta efecto
            }
            changeQuote();
            setInterval(changeQuote, 120000); // Cambiar cada 2 minutos
        });
    </script>
</body>

</html>